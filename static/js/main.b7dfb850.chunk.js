(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{116:function(e,t,n){},147:function(e,t){},149:function(e,t){},157:function(e,t,n){},158:function(e,t,n){},159:function(e,t,n){"use strict";n.r(t);var c,a=n(1),o=n.n(a),i=n(34),r=n.n(i),s=(n(87),n(25)),u=n(4),l=n.p+"static/media/Doctor.ba69d75e.svg",d=n(0),j=function(e){var t=e.createRoomButton,n=void 0!==t&&t,c=e.buttonText,a=e.onClickHandler,o=n?"create_room_button":"join_room_button";return Object(d.jsx)("button",{className:o,onClick:a,children:c})},m=function(){var e=Object(u.f)();return Object(d.jsxs)("div",{className:"introduction_page_container",children:[Object(d.jsx)("div",{className:"introduction_page_panel",children:Object(d.jsxs)("div",{className:"connecting_buttons_container",children:[Object(d.jsx)("img",{className:"round",src:"https://img.icons8.com/office/80/undefined/person-male.png"}),Object(d.jsx)("br",{}),Object(d.jsx)(j,{buttonText:"Join a meeting",onClickHandler:function(){e.push("/join-room")}})]})}),Object(d.jsx)("div",{className:"introduction_page_panel",children:Object(d.jsxs)("div",{className:"connecting_buttons_container",children:[Object(d.jsx)("img",{className:"round",src:"https://img.icons8.com/office/80/undefined/doctor-female.png"}),Object(d.jsx)("br",{}),Object(d.jsx)(j,{createRoomButton:!0,buttonText:"Host a meeting",onClickHandler:function(){e.push("/join-room?host=true")}})]})})]})},O=n(5),b={SET_IS_ROOM_HOST:"SET_IS_ROOM_HOST",SET_CONNECT_ONLY_WITH_AUDIO:"SET_CONNECT_ONLY_WITH_AUDIO",SET_IDENTITY:"SET_IDENTITY",SET_ROOM_ID:"SET_ROOM_ID",SET_SHOW_OVERLAY:"SET_SHOW_OVERLAY",SET_PARTICIPANTS:"SET_PARTICIPANTS",SET_MESSAGES:"SET_MESSAGES"},f=function(e){return{type:b.SET_IS_ROOM_HOST,isRoomHost:e}},h=function(e){return{type:b.SET_ROOM_ID,roomId:e}},p=function(e){return{type:b.SET_SHOW_OVERLAY,showOverlay:e}},v=b,_=(n(97),Object(O.b)(null,(function(e){return{setIsRoomHostAction:function(t){return e(f(t))}}}))((function(e){var t=e.setIsRoomHostAction;return Object(a.useEffect)((function(){t(!1)}),[]),Object(d.jsxs)("div",{className:"main_page_container",children:[Object(d.jsx)("img",{src:l,className:"introduction_page_image"}),Object(d.jsx)(m,{})]})}))),g=n(3),x=function(e){var t=e.isRoomHost?"Host meeting":"Join meeting";return Object(d.jsx)("p",{className:"join_room_title",children:t})},A=n(8),y=n.n(A),N=n(18),S=n(7),E=function(e){var t=e.placeholder,n=e.value,c=e.changeHandler;return Object(d.jsx)("input",{value:n,onChange:c,className:"join_room_input",placeholder:t})},T=function(e){var t=e.roomIdValue,n=e.setRoomIdValue,c=e.nameValue,a=e.phoneValue,o=e.setNameValue,i=e.setPhoneValue,r=e.isRoomHost;return Object(d.jsxs)("div",{className:"join_room_inputs_container",children:[!r&&Object(d.jsx)(E,{placeholder:"Enter meeting ID",value:t,changeHandler:function(e){n(e.target.value)}}),Object(d.jsx)(E,{placeholder:"Enter your Name",value:c,changeHandler:function(e){o(e.target.value)}}),Object(d.jsx)(E,{placeholder:"Enter your Phone",value:a,changeHandler:function(e){i(e.target.value)}})]})},I=function(e){var t=e.connectOnlyWithAudio,n=e.setConnectOnlyWithAudio;return Object(d.jsxs)("div",{className:"checkbox_container",children:[Object(d.jsx)("div",{className:"checkbox_connection",onClick:function(){n(!t)},children:t&&Object(d.jsx)("img",{className:"checkbox_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABiSURBVHgB7ZHBCQAgCEUdpREaoY0boREaoREawQw8hNShFLz04EOHz8MU4OMKIgZKpkTQwrJG6fMNGoRMN52fjMvltI/ryWaJy01Kn7+5k6p3JqTJ5ACLFE2uuUiriezjywAgdcf6AfL4kwAAAABJRU5ErkJggg=="})}),Object(d.jsx)("p",{className:"checkbox_container_paragraph",children:"Only audio"})]})},k=function(e){var t=e.errorMessage;return Object(d.jsx)("div",{className:"error_message_container",children:t&&Object(d.jsx)("p",{className:"error_message_paragraph",children:t})})},C=function(e){var t=e.buttonText,n=e.cancelButton,c=void 0!==n&&n,a=e.onClickHandler,o=c?"join_room_cancel_button":"join_room_success_button";return Object(d.jsx)("button",{onClick:a,className:o,children:t})},R=function(e){var t=e.handleJoinRoom,n=e.isRoomHost?"Host":"Join",c=Object(u.f)();return Object(d.jsxs)("div",{className:"join_room_buttons_container",children:[Object(d.jsx)(C,{buttonText:n,onClickHandler:t}),Object(d.jsx)(C,{buttonText:"Cancel",cancelButton:!0,onClickHandler:function(){c.push("/")}})]})},w=n(79),H=n.n(w),M=function(){var e=Object(N.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.a.get("".concat("https://04fa-37-73-103-44.eu.ngrok.io/api","/room-exists/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=Object(O.b)((function(e){return Object(g.a)({},e)}),(function(e){return{setConnectOnlyWithAudio:function(t){return e(function(e){return{type:b.SET_CONNECT_ONLY_WITH_AUDIO,onlyWithAudio:e}}(t))},setIdentityAction:function(t){return e(function(e){return{type:b.SET_IDENTITY,identity:e}}(t))},setRoomIdAction:function(t){return e(h(t))}}}))((function(e){var t=e.isRoomHost,n=e.setConnectOnlyWithAudio,c=e.connectOnlyWithAudio,o=e.setIdentityAction,i=e.setRoomIdAction,r=Object(a.useState)(""),s=Object(S.a)(r,2),l=s[0],j=s[1],m=Object(a.useState)(""),O=Object(S.a)(m,2),b=O[0],f=O[1],h=Object(a.useState)(""),p=Object(S.a)(h,2),v=p[0],_=p[1],g=Object(a.useState)(null),x=Object(S.a)(g,2),A=x[0],E=x[1],C=Object(u.f)(),w=function(){var e=Object(N.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o(b),!t){e.next=5;break}W(),e.next=7;break;case 5:return e.next=7,H();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(N.a)(y.a.mark((function e(){var t,n,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M(l);case 2:t=e.sent,n=t.roomExists,c=t.full,n?c?E("Meeting is full. Please try again later."):(i(l),C.push("/room")):E("Meeting not found. Check your meeting id.");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=function(){C.push("/room")};return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(T,{roomIdValue:l,setRoomIdValue:j,nameValue:b,setNameValue:f,phoneValue:v,setPhoneValue:_,isRoomHost:t}),Object(d.jsx)(I,{setConnectOnlyWithAudio:n,connectOnlyWithAudio:c}),Object(d.jsx)(k,{errorMessage:A}),Object(d.jsx)(R,{handleJoinRoom:w,isRoomHost:t})]})})),B=(n(116),Object(O.b)((function(e){return Object(g.a)({},e)}),(function(e){return{setIsRoomHostAction:function(t){return e(f(t))}}}))((function(e){var t=e.setIsRoomHostAction,n=e.isRoomHost,c=Object(u.g)().search;return Object(a.useEffect)((function(){new URLSearchParams(c).get("host")&&t(!0)}),[]),Object(d.jsx)("div",{className:"join_room_page_container",children:Object(d.jsxs)("div",{className:"join_room_page_panel",children:[Object(d.jsx)(x,{isRoomHost:n}),Object(d.jsx)(W,{})]})})}))),L=function(){return Object(d.jsx)("div",{className:"chat_label_container",children:Object(d.jsx)("p",{className:"chat_label_paragraph",children:"CHAT"})})},U=function(e){var t=e.author,n=e.content,c=e.sameAuthor,a=e.messageCreatedByMe,o=a?"message_align_right":"message_align_left",i=a?"You":t,r=a?"message_right_styles":"message_left_styles";return Object(d.jsxs)("div",{className:"message_container ".concat(o),children:[!c&&Object(d.jsx)("p",{className:"message_title",children:i}),Object(d.jsx)("p",{className:"message_content ".concat(r),children:n})]})},D=Object(O.b)((function(e){return Object(g.a)({},e)}))((function(e){var t=e.messages;return Object(d.jsx)("div",{className:"messages_container",children:t.map((function(e,n){var c=n>0&&e.identity===t[n-1].identity;return Object(d.jsx)(U,{author:e.identity,content:e.content,sameAuthor:c,messageCreatedByMe:e.messageCreatedByMe},"".concat(e.content).concat(n))}))})})),V=n.p+"static/media/sendMessageButton.21b28e18.svg",Y=n(44),P=n(82),J={identity:"",isRoomHost:!1,connectOnlyWithAudio:!1,roomId:null,showOverlay:!0,participants:[],messages:[]},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v.SET_IS_ROOM_HOST:return Object(g.a)(Object(g.a)({},e),{},{isRoomHost:t.isRoomHost});case v.SET_CONNECT_ONLY_WITH_AUDIO:return Object(g.a)(Object(g.a)({},e),{},{connectOnlyWithAudio:t.onlyWithAudio});case v.SET_ROOM_ID:return Object(g.a)(Object(g.a)({},e),{},{roomId:t.roomId});case v.SET_IDENTITY:return Object(g.a)(Object(g.a)({},e),{},{identity:t.identity});case v.SET_SHOW_OVERLAY:return Object(g.a)(Object(g.a)({},e),{},{showOverlay:t.showOverlay});case v.SET_PARTICIPANTS:return Object(g.a)(Object(g.a)({},e),{},{participants:t.participants});case v.SET_MESSAGES:return Object(g.a)(Object(g.a)({},e),{},{messages:t.messages});default:return e}},Q=Object(P.a)({reducer:G}),F=Q,K=n(80),z=n.n(K),X=null,Z=function(){(X=z()("https://04fa-37-73-103-44.eu.ngrok.io")).on("connect",(function(){console.log("successfully connected with socket io server"),console.log(X.id)})),X.on("room-id",(function(e){var t=e.roomId;F.dispatch(h(t))})),X.on("room-update",(function(e){var t=e.connectedUsers;F.dispatch({type:b.SET_PARTICIPANTS,participants:t})})),X.on("conn-prepare",(function(e){var t=e.connUserSocketId;re(t,!1),X.emit("conn-init",{connUserSocketId:t})})),X.on("conn-signal",(function(e){se(e)})),X.on("conn-init",(function(e){var t=e.connUserSocketId;re(t,!0)})),X.on("user-disconnected",(function(e){ue(e)}))},q=function(e,t){var n={identity:e,onlyAudio:t};X.emit("create-new-room",n)},$=function(e,t,n){var c={roomId:t,identity:e,onlyAudio:n};X.emit("join-room",c)},ee=n(81),te=n.n(ee),ne={audio:!0,video:!0},ce={audio:!0,video:!1},ae=function(){var e=Object(N.a)(y.a.mark((function e(t,n){var a,o,i,r=arguments;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=r.length>2&&void 0!==r[2]?r[2]:null,o=r.length>3?r[3]:void 0,i=o?ce:ne,navigator.mediaDevices.getUserMedia(i).then((function(e){console.log("successfuly received local stream"),le(c=e),F.dispatch(p(!1)),t?q(n,o):$(n,a,o)})).catch((function(e){console.log("error occurred when trying to get an access to local stream"),console.log(e)}));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),oe={},ie=[],re=function(e,t){var n={iceServers:[{urls:"stun:stun.l.google.com:19302"}]};oe[e]=new te.a({initiator:t,config:n,stream:c,channelName:"messenger"}),oe[e].on("signal",(function(t){!function(e){X.emit("conn-signal",e)}({signal:t,connUserSocketId:e})})),oe[e].on("stream",(function(t){console.log("new stream came"),de(t,e),ie=[].concat(Object(Y.a)(ie),[t])})),oe[e].on("data",(function(e){var t=JSON.parse(e);be(t)}))},se=function(e){oe[e.connUserSocketId].signal(e.signal)},ue=function(e){var t=e.socketId,n=document.getElementById(t),c=document.getElementById("".concat(t,"-video"));n&&c&&(c.srcObject.getTracks().forEach((function(e){return e.stop()})),c.srcObject=null,n.removeChild(c),n.parentNode.removeChild(n),oe[t]&&oe[t].destroy(),delete oe[t])},le=function(e){var t=document.getElementById("videos_portal");t.classList.add("videos_portal_styles");var n=document.createElement("div");n.classList.add("video_track_container");var c=document.createElement("video");c.autoplay=!0,c.muted=!0,c.srcObject=e,c.onloadedmetadata=function(){c.play()},n.appendChild(c),F.getState().connectOnlyWithAudio&&n.appendChild(je()),t.appendChild(n)},de=function(e,t){var n=document.getElementById("videos_portal"),c=document.createElement("div");c.id=t,c.classList.add("video_track_container");var a=document.createElement("video");a.autoplay=!0,a.srcObject=e,a.id="".concat(t,"-video"),a.onloadedmetadata=function(){a.play()},a.addEventListener("click",(function(){a.classList.contains("full_screen")?a.classList.remove("full_screen"):a.classList.add("full_screen")})),c.appendChild(a);var o=F.getState().participants.find((function(e){return e.socketId===t}));console.log(o),(null===o||void 0===o?void 0:o.onlyAudio)?c.appendChild(je(o.identity)):c.style.position="static",n.appendChild(c)},je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("div");t.classList.add("label_only_audio_container");var n=document.createElement("p");return n.classList.add("label_only_audio_text"),n.innerHTML="Only audio ".concat(e),t.appendChild(n),t},me=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Oe(e?c:t)},Oe=function(e){for(var t in oe)for(var n in oe[t].streams[0].getTracks())for(var c in e.getTracks())if(oe[t].streams[0].getTracks()[n].kind===e.getTracks()[c].kind){oe[t].replaceTrack(oe[t].streams[0].getTracks()[n],e.getTracks()[c],oe[t].streams[0]);break}},be=function(e){var t=F.getState().messages;F.dispatch(function(e){return{type:b.SET_MESSAGES,messages:e}}([].concat(Object(Y.a)(t),[e])))},fe=function(){var e=Object(a.useState)(""),t=Object(S.a)(e,2),n=t[0],c=t[1],o=function(){n.length>0&&(!function(e){var t=F.getState().identity;be({content:e,identity:t,messageCreatedByMe:!0});var n={content:e,identity:t},c=JSON.stringify(n);for(var a in oe)oe[a].send(c)}(n),c(""))};return Object(d.jsxs)("div",{className:"new_message_container",children:[Object(d.jsx)("input",{className:"new_message_input",value:n,onChange:function(e){c(e.target.value)},placeholder:"Type your message ...",type:"text",onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),o())}}),Object(d.jsx)("img",{className:"new_message_button",src:V,onClick:o})]})},he=function(){return Object(d.jsxs)("div",{className:"chat_section_container",children:[Object(d.jsx)(L,{}),Object(d.jsx)(D,{}),Object(d.jsx)(fe,{})]})},pe=function(){return Object(d.jsx)("div",{className:"participants_label_container",children:Object(d.jsx)("p",{className:"participants_label_paragraph",children:"PARTICIPANTS"})})},ve=function(e){var t=e.identity,n=e.lastItem;e.participant;return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("p",{className:"participants_paragraph",children:t}),!n&&Object(d.jsx)("span",{className:"participants_separator_line"})]})},_e=Object(O.b)((function(e){return Object(g.a)({},e)}))((function(e){var t=e.participants;return Object(d.jsx)("div",{className:"participants_container",children:t.map((function(e,n){return Object(d.jsx)(ve,{lastItem:t.length===n+1,participant:e,identity:e.identity},e.identity)}))})})),ge=function(){return Object(d.jsxs)("div",{className:"participants_section_container",children:[Object(d.jsx)(pe,{}),Object(d.jsx)(_e,{})]})},xe=n.p+"static/media/camera.618153de.svg",Ae=n.p+"static/media/cameraOff.70f16345.svg",ye=function(){var e=Object(a.useState)(!1),t=Object(S.a)(e,2),n=t[0],o=t[1];return Object(d.jsx)("div",{className:"video_button_container",children:Object(d.jsx)("img",{src:n?Ae:xe,className:"video_button_image",onClick:function(){var e;e=n,c.getVideoTracks()[0].enabled=!!e,o(!n)}})})},Ne=function(){return Object(d.jsx)("div",{className:"video_button_container",children:Object(d.jsx)("button",{className:"video_button_end",onClick:function(){var e=window.location.origin;window.location.href=e},children:"Leave Room"})})},Se=n.p+"static/media/mic.7a73c4c9.svg",Ee=n.p+"static/media/micOff.e9ff196e.svg",Te=function(){var e=Object(a.useState)(!1),t=Object(S.a)(e,2),n=t[0],o=t[1];return Object(d.jsx)("div",{className:"video_button_container",children:Object(d.jsx)("img",{src:n?Ee:Se,onClick:function(){var e;e=n,c.getAudioTracks()[0].enabled=!!e,o(!n)},className:"video_button_image"})})},Ie=n.p+"static/media/switchToScreenSharing.af807573.svg",ke=function(e){var t=e.stream,n=Object(a.useRef)();return Object(a.useEffect)((function(){var e=n.current;e.srcObject=t,e.onloadedmetadata=function(){e.play()}}),[t]),Object(d.jsx)("div",{className:"local_screen_share_preview",children:Object(d.jsx)("video",{muted:!0,autoPlay:!0,ref:n})})},Ce={audio:!1,video:!0},Re=function(){var e=Object(a.useState)(!1),t=Object(S.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(null),i=Object(S.a)(o,2),r=i[0],s=i[1],u=function(){var e=Object(N.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=14;break}return t=null,e.prev=2,e.next=5,navigator.mediaDevices.getDisplayMedia(Ce);case 5:t=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log("error occurred when trying to get an access to screen share stream");case 11:t&&(s(t),me(n,t),c(!0)),e.next=18;break;case 14:me(n),c(!1),r.getTracks().forEach((function(e){return e.stop()})),s(null);case 18:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(){return e.apply(this,arguments)}}();return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("div",{className:"video_button_container",children:Object(d.jsx)("img",{src:Ie,onClick:u,className:"video_button_image"})}),n&&Object(d.jsx)(ke,{stream:r})]})},we=Object(O.b)((function(e){return Object(g.a)({},e)}))((function(e){var t=e.connectOnlyWithAudio;return Object(d.jsxs)("div",{className:"video_buttons_container",children:[Object(d.jsx)(Te,{}),!t&&Object(d.jsx)(ye,{}),Object(d.jsx)(Ne,{}),!t&&Object(d.jsx)(Re,{})]})})),He=function(){return Object(d.jsx)("div",{className:"video_section_container",children:Object(d.jsx)(we,{})})},Me=function(e){var t=e.roomId;return Object(d.jsx)("div",{className:"room_label",children:Object(d.jsxs)("p",{className:"room_label_paragraph",children:["ID: ",t," "]})})},We=function(){return Object(d.jsx)("div",{className:"overlay_container",children:Object(d.jsx)("div",{className:"loader"})})},Be=(n(157),Object(O.b)((function(e){return Object(g.a)({},e)}))((function(e){var t=e.roomId,n=e.identity,c=e.isRoomHost,o=e.showOverlay,i=e.connectOnlyWithAudio;return Object(a.useEffect)((function(){if(c||t)ae(c,n,t,i);else{var e=window.location.origin;window.location.href=e}}),[]),Object(d.jsxs)("div",{className:"room_container",children:[Object(d.jsx)(ge,{}),Object(d.jsx)(He,{}),Object(d.jsx)(he,{}),Object(d.jsx)(Me,{roomId:t}),o&&Object(d.jsx)(We,{})]})})));n(158);var Le=function(){return Object(a.useEffect)((function(){Z()}),[]),Object(d.jsx)(s.a,{children:Object(d.jsxs)(u.c,{children:[Object(d.jsx)(u.a,{path:"/join-room",children:Object(d.jsx)(B,{})}),Object(d.jsx)(u.a,{path:"/room",children:Object(d.jsx)(Be,{})}),Object(d.jsx)(u.a,{path:"/",children:Object(d.jsx)(_,{})})]})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(Object(d.jsx)(o.a.StrictMode,{children:Object(d.jsx)(O.a,{store:Q,children:Object(d.jsx)(Le,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},87:function(e,t,n){},97:function(e,t,n){}},[[159,1,2]]]);
//# sourceMappingURL=main.b7dfb850.chunk.js.map